<!DOCTYPE html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>Dashbord</title>
    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="../static/css/bootstrap.min.css">
    <link rel="stylesheet" href="../static/css/jquery-ui.css">
    <link rel="stylesheet" href="../static/css/chartist.css">
    <link rel="stylesheet" href="../static/css/bulma.css">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
    <script src="../static/js/chartist.js"></script>
    <!-- jQuery first, then Tether, then Bootstrap JS. -->
    <script src="../static/js/jquery-3.2.1.min.js" ></script>
    <script src="../static/js/jquery-ui.js" ></script>
    <script src="../static/js/bootstrap.min.js"></script>
    <style>
      body{
        background-color: #EADBC4;
      }
      h1{
        color: #000000;
        font-size: 30px;
      }
      nav {
        color: #ffffff;
        font-size: 30px;
        margin: 10px 0px !important;
      }
      .panel-head{
        color: #ffffff;
        background-color:#000000;
        font-size: 30px;
        padding:10px 0px !important;
      }
      .chart{
        height: 400px;
        margin: 10px 0px;
      }
      #summary p{
        font-size: 20px;
        border: solid;
        border-width: medium;
        text-align: left;
      }
    </style>
  </head>
  <body>
    <div class="container box">
      <div class="row text-center">
        <h1> Analysis Dashbord</h1>
      </div>
    </div>
    <div class="container">
      <div class="row">
        <!-- start naviagtion column -->
        <div class="col-md-3 text-center">
          <div class="row box">
            <div class="panel panel-info">
              <div class="panel-body panel-head">Overviews</div>
              <div class="panel-footer">
                <div  class="control-label">
                  <label class="label">Summary of the data.</label>
                </div>
              </div>
            </div>
          </div>
          <div class="row box">
            <div class="panel panel-info">
              <div class="panel-body panel-head">Details</div>
              <div class="panel-footer">
                <div  class="control-label">
                  <label class="label">Visualized data in details.</label>
                </div>
                <div class="control is-horizontal">
                  <div  class="control-label">
                    <label class="label">Time interval:</label>
                  </div>
                  <div class="control">
                    <div  class="select is-fullwidth">
                      <select id="interval">
                        <option value="Hour" selected>Hour</option>
                        <option value="Day">Day</option>
                        <option value="Week">Week</option>
                        <option value="Month">Month</option>
                        <option value="Quarter">Quarter</option>
                      </select>
                    </div>
                  </div>
                </div>
                <div  class="control-label">
                  <label class="label">Period:</label>
                </div>
                <input class="select is-fullwidth" id="dateOne">
                <div style="padding-top:10px"></div>
                <input type="submit" class="button is-primary" value="Refresh">
              </div>
            </div>
          </div>
        </div>
        <!-- end naviagtion column -->

        <!-- start image column -->
        <div class="col-md-offset-1 col-md-8 text-center">
          <div class="row box">
            <div id="summary" style="height:100px;"></div>
          </div>
          <div class="row box">
            <h1>Top-10-Users:</h1>
            <div id="topUserBar" class="chart" ></div>

          </div>
          <div class="row box">
            <h1>Top-10-Items(Sales):</h1>
            <div id="topItemSales"  class="chart" ></div>
          </div>
          <div class="row box">
            <h1>Top-10-Items(Incomes):</h1>
            <div id="topItemValues"  class="chart" ></div>
          </div>
        </div>
        <!-- start image column -->
    </div>
    <script>
      var summary = {{ summary | safe }};
      var sumText = [];
      sumText.push("<p>"+"Total number of users: "+summary.nb_user+"</p>");
      sumText.push("<p>"+"Total types of items: "+summary.nb_items+"</p>");
      sumText.push("<p>"+"Total sales value: "+summary.total_cost+"</p>");
      $("#summary").append(sumText);
      new Chartist.Bar('#topUserBar', {
        labels: summary.top_10_user,
        series: [
          summary.top_10_user_cost
        ]
      }, {
        seriesBarDistance: 10,
        reverseData: true,
        horizontalBars: true,
        axisY: {
          offset: 50
        },
        axisX: {
          offset: 100
        }
      });
      new Chartist.Bar('#topItemSales', {
        labels: summary.top_10_sales_item,
        series: [
          summary.top_10_sales_sales
        ]
      }, {
        seriesBarDistance: 10,
        horizontalBars: false,
        axisY: {
          offset: 50
        },
        axisX: {
          offset: 100
        }
      });
      new Chartist.Bar('#topItemValues', {
        labels: summary.top_10_value_item,
        series: [
          summary.top_10_value_values
        ]
      }, {
        seriesBarDistance: 10,
        horizontalBars: false,
        axisY: {
          offset: 50
        },
        axisX: {
          offset: 100
        }
      });
    </script>

    <script>
      $(document).ready(function() {
        $("#dateOne").datepicker();
      });
      $("#interval").change(function(){
          if ($("#interval").val() == "Hour" || $("#interval").val() == "Day"){
            if ($("#dateTwo")[0]){
              $("#dateTwo").remove();
            }
          }else{
            if ($("#dateTwo")[0]){
              console.log('date two already exist');
            }else{
              $('<input class="select is-fullwidth" id="dateTwo">').insertAfter($('#dateOne'));
              $("#dateTwo").datepicker();
            }
          }
        });
    </script>
  </body>
</html>
